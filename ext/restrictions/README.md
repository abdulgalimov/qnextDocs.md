# Ограничения

Ограничение - исполняемый модуль, который проверяет выполнение условия для срабатывания. 
Действие будет выполнено, если ограничение вернет TRUE в процессе проверки.

## bool 

Условие проверяет наличие значения в указанной переменной или отсутствие самой переменной.

| Режим | Описание | 
| --- | --- | 
| ✅ | переменная содержит значение |
| ❌ | переменная не содержит значение или не определена |

**Пример 1:**
 
![](./1.jpg)
 
| Пример | Описание | 
| --- | --- | 
| ✅```${update.message.text}``` | Условие сработает, если отправлено текстовое сообщение |
| ❌```${update.message.text}``` | Условие сработает, если в объекте не будет пути ```${update.message.text}``` |

**Пример 2:**

![](./2.jpg)

| Пример | Описание | 
| --- | --- | 
| ✅```${reactionResult.ok}``` | Условие сработает, если параметр равен ```true``` |
| ❌```${reactionResult.ok}``` | Условие сработает, если параметр равен ```false``` или будет отсутствовать |


## botStarted

Условие проверяет, запущен ли бот у пользователя в привате. Это важно например когда вы хотите отправить рассылку своим пользователям.

| Режим | Описание | 
| --- | --- | 
| ✅ | Юзер запускал бота |
| ❌ | Юзер не запускал бота |

## hasAttachment

Условие проверяет наличие или отсутствие файла, любого типа или какого то определенного.

Поддерживает проверку следующих типов файлов:

| Режим | Описание | 
| --- | --- | 
| **Любой файл** | Проверяет наличие любого типа файла |
| **Фото** | ```${update.message.photo}``` |
| **Видео** | ```${update.message.video}``` |
| **Видеозаметка** | ```${update.message.video_note}``` |
| **Аудио** | ```${update.message.audio}``` |
| **Голосовое** | ```${update.message.voice}``` |
| **Файл** | ```${update.message.file}``` |
| **Анимация** | ```${update.message.dice}``` |
| **Стикер** | ```${update.message.sticker}``` |


## hasUsername

Условие проверяет наличия Юзернейма (@username) у пользователя 

* Ограничение работает так же, как ограничение bool, только проверяет определенный путь: ${update.message.from.username}

| Режим | Описание | 
| --- | --- | 
| ✅ | У пользователя есть юзернейм |
| ❌ | У пользователя отсутствует юзернейм |


## inGroup

Условие проверяет где была запущена реакция.

Проверяет параметр ```${update.message.chat.type}```

| Режим | Описание | 
| --- | --- | 
| ❌ - ```${update.message.chat.type}``` | - действие совершено в привате с ботом |
| ✅ - ```${update.message.chat.type}``` | - действие совершено не в привате |


## inUserList

Условие проверяет, является ли пользователь участником списка пользователей

| Режим | Описание | 
| --- | --- | 
| ✅ | Состоит в списке пользователей (если пропустить выбор определенного списка, будет проверять все списки) |
| ❌ | Не состоит в списке пользователей (если пропустить выбор определенного списка, будет проверять все списки) |


## isAdmin

Условие проверяет, является ли пользователь админом бота

| Режим | Описание | 
| --- | --- | 
| ✅ | Является админом бота |
| ❌ | Не является админом бота |


## isAuthor

Условие проверяет инициатора запуска.

| Режим | Описание | 
| --- | --- | 
| ✅ | Инициатор запуска |
| ❌ | Не инициатор запуска |


## isChatMember

Условие проверяет, является ли пользователь участником чата/канала. 

| Режим | Описание | 
| --- | --- | 
| ✅ | Пользователь является участником чата/канал |
| ❌ | Пользователь не является участником чата/канал |

::: tip Обязательно

* Подключить бота к чату/каналу
* Выдать права админа
* ограничению должен быть очевидно доступен ID чата, либо из указания чата, либо из переменной ```${chat.id}``` 
:::

## isChatAdmin

Условие проверяет, является ли пользователь админом в чате

| Режим | Описание | 
| --- | --- | 
| ✅ | Пользователь является админом чата/канал |
| ❌ | Пользователь не является админом чата/канал |

::: tip Обязательно

* Подключить бота к чату/каналу
* Выдать права админа
* ограничению должен быть очевидно доступен ID чата, либо из указания чата, либо из переменной ```${chat.id}``` или ```${targetChat.id}```
:::


# isCommand

Условие покажет, является ли текущий текст от пользователя командой вида /command_name

| Режим | Описание | 
| --- | --- | 
| ✅ | Текст отправлен командой |
| ❌ | Текст отправлен не командой |

## isDisable

Проверяет отключена ли кнопка в меню, опцией ☑️Выключить в настройках кнопки.


## isForwardMessage

Условие проверяет была ли пересылка сообщения

Проверяет наличие параметра ```${update.message.forward_from}```

| Режим | Описание | 
| --- | --- | 
| ✅ | сообщение является пересланным |
| ❌ | сообщение не является пересланным |


## isReplyMessage

Условие проверяет, была ли запущена реакция ответом на сообщение

Проверяет наличие параметра ```${update.message.reply_to_message}```

| Режим | Описание | 
| --- | --- | 
| ✅ | сообщение отправлено в ответ на другое сообщение |
| ❌ | сообщение отправлено не в ответ на другое сообщение |

## isSystemBot

Условие проверяет кто запустил реакцию, человек или бот.

* Это касается технических Телеграм аккаунтов типа +777000, у которых стоит пометка ```${user.is_bot}``` = true

## isViaBot

Условие проверяет кто отправил сообщение бот или нет.

Проверяет наличие параметра ```${update.message.via_bot}```

| Режим | Описание | 
| --- | --- | 
| ✅ | сообщение отправлено с помощью бота |
| ❌ | сообщение отправлено без помощи бота |


## listContains

Условие проверяет наличие значения в списке (массиве) значений.


## mapSetting

Условие проверяет карту настроек.
В настройках различных сущностей  есть свой mapSettings (карта настроек). Например карта настроек есть у кнопок Контента, Меню и полей Формы. Например если на кнопке Меню задать определенную карту настроек (mapSettings), то можно в общем Тригере До или После сделать проверку карты настроек, и при определенных значениях выполнить необходимую реакцию.


## number

Условие проверяет числовое значение в переменной.

Поддерживает следующие виды проверок:

| Значение | Описание | 
| --- | --- | 
| = | значение равно заданному числу |
| ≠ | значение не равно заданному числу |
| \<= | значение меньше или равно заданному числу |
| \>= | значение больше или равно заданному числу |
| \< | значение меньше заданного числа |
| \> | значение больше заданного числа |


## [**ProfileValue**](/docs/admin/profile/profilevalue) 

Условие проверяет значение профиля. Этим можно ограничить возможность пользоваться функциями.

Поддерживает следующие виды проверок:

Если профиль типа ```строка```:

| Режим | Описание | 
| --- | --- | 
| ✅ | профиль не пуст |
| ❌ | профиль пуст |
| = | параметр равен значению |
| ≠ | параметр не равен значению |
| ☑ | содержит искомое слово |
| ⬜ | не содержит искомое слово |

Если профиль типа ```целое число```:

| Режим | Описание | 
| --- | --- | 
| ✅ | профиль не пуст |
| ❌ | профиль пуст |
| = | параметр равен значению |
| < | профиль меньше значения |
| \> | профиль больше значения |
| \<= | профиль меньше или равен значению |
| \>= | профиль больше или равен значению |

## regex

Ограничение позволяет содержимое переменной с помощью регулярного выражения.

Максимальная длина регулярного выражения 128 символов


## string

Условие проверяет равенство строк, а также вхождение подстроки в строку. 
Используется для сопоставления строк.
Строкой считается параметр находящийся в двойных скобках: ""

Поддерживает следующие виды проверок:

| Режим | Описание | 
| --- | --- | 
| = | строка совпадает с указанным текстом |
| ≠ | строка не совпадает с указанным текстом |
| ☑ | строка содержит указанный текст |
| ⬜ | строка не содержит указанный текст |

Примеры: 

![](./3.jpg)

| Пример | Описание |
| --- | --- |
| ```${update.message.text}``` — = — custom text | Условие сработает, если текст совпадает с указанным |
| ```${update.message.text}``` — ≠ — custom text | Условие сработает, если текст не совпадает с указанным |
| ```${update.message.text}``` — ☑ — text | Условие сработает, если в тексте есть указанное слово |
| ```${update.message.text}``` — ⬜ — text | Условие сработает, если в тексте нет указанного слова |

## userActionResult

Условие проверяет запущено ли Отложенное действие (далее ОД) для пользователя.

Имеет 2 режима работы:

**Определение условия срабатывания**

| Режим | Описание | 
| --- | --- | 
| = | Параметр соответствует указанному |
| ≠ | Параметр не соответствует указанному |

**Указание параметра для проверки**

| Параметр | Описание | 
| --- | --- | 
| **created** | ОД запущено |
| **replaced** | ОД продублировано (режим дублирования) |
| **exist** | ОД отменено |
| **finish** | ОД закончено |

## userLanguage

Условие проверяет установленный язык пользователя бота.

Поддерживает языки, указанные в настройках бота. 

* Установить язык можно с помощью реакциии [setLanguage](/docs/admin/other/reactions/setuserlanguage)

## voteClosed

Условие проверяет закрыто ли голосование в опросе

| Режим | Описание | 
| --- | --- | 
| ✅ | Голосование закрыто |
| ❌ | Голосование работает |

## voteResult

Условие проверяет результат голосования.
Доступны следующие значения:

| Значение | Описание | 
| --- | --- | 
| **none** | голоса нет |
| **changed** | голос изменен (изменение выбора в этот момент) |
| **exist** | голос уже есть (есть и его нельзя отменить) |
| **withdraw** | голос отменен (удаление в этот момент) |
| **error** | "что за ерунда творится" |
| **buttonLimit** | достигнуто ограничение количества голосов (за эту кнопку - за эту группу🔡) |
| **created** | голос создан(добавление голоса в этот момент) |


## votesAllCount

Условие проверяет общее количество голосов в опросе и сравнивает с указанным значением.

| Режим | Описание | 
| --- | --- | 
| \= | Количество голосов равно заданному |
| \< | Количество голосов меньше заданного |
| \> | Количество голосов выше заданного |

## votesButtonCount

Условие проверяет количество голосов в текущей кнопке и сравнивает с указанным значением.

| Режим | Описание | 
| --- | --- | 
| \= | Количество голосов равно заданному |
| \< | Количество голосов меньше заданного |
| \> | Количество голосов выше заданного |